"use strict";(self.webpackChunkmanifold_kb=self.webpackChunkmanifold_kb||[]).push([[958],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return u}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),d=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),m=d(r),u=a,k=m["".concat(l,".").concat(u)]||m[u]||s[u]||o;return r?n.createElement(k,i(i({ref:t},c),{},{components:r})):n.createElement(k,i({ref:t},c))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:a,i[1]=p;for(var d=2;d<o;d++)i[d]=r[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},1751:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return p},metadata:function(){return d},toc:function(){return s}});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),i=["components"],p={id:"rpc-dapp-support",title:"DApp Error Support",description:"RPC Error Types and Structures for DApps",sidebar_position:3},l="DApp Error Support",d={unversionedId:"Rpc/rpc-dapp-support",id:"Rpc/rpc-dapp-support",title:"DApp Error Support",description:"RPC Error Types and Structures for DApps",source:"@site/docs/Rpc/error-types-for-dapps.md",sourceDirName:"Rpc",slug:"/Rpc/rpc-dapp-support",permalink:"/docs/Rpc/rpc-dapp-support",draft:!1,editUrl:"https://github.com/manifoldfinance/kb/tree/trunk/docs/Rpc/error-types-for-dapps.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"rpc-dapp-support",title:"DApp Error Support",description:"RPC Error Types and Structures for DApps",sidebar_position:3},sidebar:"docsSidebar",previous:{title:"JSON RPC Overview",permalink:"/docs/Rpc/"},next:{title:"Error encoding and responses",permalink:"/docs/Rpc/ref-error-codes-rpc"}},c={},s=[{value:"Motivation",id:"motivation",level:2},{value:"DApp Error Support",id:"dapp-error-support-1",level:2},{value:"Define a standard for Ethereum JSON-RPC errors.",id:"define-a-standard-for-ethereum-json-rpc-errors",level:3},{value:"Error structure",id:"error-structure",level:3},{value:"Error categories",id:"error-categories",level:3},{value:"Error details",id:"error-details",level:2},{value:"Example",id:"example",level:3}],m={toc:s};function u(e){var t=e.components,r=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"dapp-error-support"},"DApp Error Support"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"See the Error Encoding Guide for example codes")),(0,o.kt)("h2",{id:"motivation"},"Motivation"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ethereum/wiki/wiki/JSON-RPC"},"RPC specification")," implements a subset of the ",(0,o.kt)("a",{parentName:"p",href:"http://www.jsonrpc.org/specification"},"JSON-RPC")," specification. It defines the available RPC methods together with in- and outputs and serialization format. It however doesn't specify anything about the errors these methods can return. As a result, implementations return different errors which makes it hard for DApp developers to act appropriately. Another problem is that currently there are no well-defined error codes. This causes some clients (e.g. Mist) to do string matching to determine what happened. This is brittle and not generic."),(0,o.kt)("h2",{id:"dapp-error-support-1"},"DApp Error Support"),(0,o.kt)("h3",{id:"define-a-standard-for-ethereum-json-rpc-errors"},"Define a standard for Ethereum JSON-RPC errors."),(0,o.kt)("p",null,"One of the problems is finding the correct balance between informing a DApp what happened and being not too specific. Being too specific will make it hard to become fully compliant with the specification and would make DApp's more complicated. Being too generic DApps' won't be able to determine what happened."),(0,o.kt)("p",null,"This problem is tackled by introducing the concept of an error category and allowing a node to supply optional extra information about an error. This allows a DApp to get a general understanding of what went wrong by looking at the category error code. It also allows a node to provide additional information about an error that the DApp can decide to use."),(0,o.kt)("p",null,"This proposal contains 2 parts. First, it describes how the errors are defined. The second part describes a list with standardized error categories and detailed error messages."),(0,o.kt)("h3",{id:"error-structure"},"Error structure"),(0,o.kt)("p",null,"JSON-RPC 2.0 has a ",(0,o.kt)("a",{parentName:"p",href:"http://www.jsonrpc.org/specification#error_object"},"section")," dedicated how errors are defined. The ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," field will be used for an error category. This field is mandatory and used by DApp's to get a general understanding of what happened. Together with the ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," field, the `message`` field is filled with a brief description of the category."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," field is an optional field. Nodes can decide to supply additional information through this field. If a node provides detailed information the data field must be an array of objects with the following fields:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Field")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Type")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Mandatory")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Code"),(0,o.kt)("td",{parentName:"tr",align:null},"Integer"),(0,o.kt)("td",{parentName:"tr",align:null},"Yes")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Description"),(0,o.kt)("td",{parentName:"tr",align:null},"String"),(0,o.kt)("td",{parentName:"tr",align:null},"No")))),(0,o.kt)("p",null,"By using this approach DApp's can get a general understanding of what happened through the ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," field. In most cases this is sufficient. It also allows nodes to supply additional information when available."),(0,o.kt)("h3",{id:"error-categories"},"Error categories"),(0,o.kt)("p",null,"The JSON-RPC 2.0 specification defines the range -32000 to -32099 for application-specific errors."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Code")),(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Category")),(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Meaning")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"-","32000"),(0,o.kt)("td",{parentName:"tr",align:"center"},"INVALID_VALUE"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Parameter Contains Invalid Value")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"-","32001"),(0,o.kt)("td",{parentName:"tr",align:"center"},"NOT_FOUND"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Requested Resource Not Found")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"-","32002"),(0,o.kt)("td",{parentName:"tr",align:"center"},"UNAVAILABLE"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Resource Not Available")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"-","32003"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Transaction Rejected")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"-","32099"),(0,o.kt)("td",{parentName:"tr",align:"center"},"MISC"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Error, Allow Nodes To Send Custom Errors")))),(0,o.kt)("h2",{id:"error-details"},"Error details"),(0,o.kt)("p",null,"If a node wants to send additional information about an error it can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," field."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Code")),(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Category")),(0,o.kt)("th",{parentName:"tr",align:"center"},(0,o.kt)("strong",{parentName:"th"},"Meaning")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"0"),(0,o.kt)("td",{parentName:"tr",align:"center"},"INVALID_VALUE"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Invalid Input, E",".","g","."," Missing Mandatory Input")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"0"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Invalid Nonce")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"1"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Unable To Sign Transaction")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"2"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Transaction Already In Tx Pool")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"3"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Transaction Gas Price Too Low For Acceptance")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"4"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Sender Account Doesn'T Exists")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"5"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Gas Limit Exceeds Block Gas Limit")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"6"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Insufficient Funds")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"7"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Insufficient Intrinsic Gas")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"8"),(0,o.kt)("td",{parentName:"tr",align:"center"},"TX_REJECTED"),(0,o.kt)("td",{parentName:"tr",align:"center"},"From Account Is Locked")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"99"),(0,o.kt)("td",{parentName:"tr",align:"center"},"*"),(0,o.kt)("td",{parentName:"tr",align:"center"},"Implementation Specific Field")))),(0,o.kt)("p",null,"It is worth noting that ",(0,o.kt)("inlineCode",{parentName:"p"},"99")," is a general code that can be used in any of the categories. It allows a node to provide non-standardized information to a DApp. Also, this table doesn't specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"description")," field. Nodes are free to choose what they put into the ",(0,o.kt)("inlineCode",{parentName:"p"},"description")," field, it is allowed to omit the ",(0,o.kt)("inlineCode",{parentName:"p"},"description")," field."),(0,o.kt)("h3",{id:"example"},"Example"),(0,o.kt)("p",null,"Value transaction from an account with a balance of 0. The node determines this transaction will always fail and rejects the transaction. The returned error would look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsonc"},'{\n    "jsonrpc": "2.0",\n    "error": {\n        "code": -32003,\n        "message": "transaction rejected",\n        "data": [\n            {\n                "code": 6,\n                "description": "insufficient funds"\n            }\n        ]\n    },\n    "id": 1234\n}\n')),(0,o.kt)("p",null,"The node doesn't use the account management most implementations provide but forwards a transaction to an external signing service. When this service could not be reached the node can return the following error:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsonc"},'{\n    "jsonrpc": "2.0",\n    "error": {\n        "code": -32003,\n        "message": "transaction rejected",\n        "data": [\n            {\n                "code": 1,\n                "description": "unable to sign transaction"\n            },\n            {\n                "code": 99,\n                "description": "signing service not available"\n            }\n        ]\n    },\n    "id": null\n}\n')))}u.isMDXComponent=!0}}]);